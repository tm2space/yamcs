<ya-instance-page>
  <ya-instance-toolbar>
    <ng-template ya-instance-toolbar-label>
      <ya-page-icon-button
        [routerLink]="['/booking']"
        [queryParams]="{ c: yamcs.context }"
        icon="arrow_back" />
      Create New Booking
    </ng-template>
  </ya-instance-toolbar>

  <ya-panel>
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="ya-form">

      <ya-field label="Provider">
        <ya-select formControlName="providerId" [options]="providerOptions" />
      </ya-field>

      <ya-field label="Satellite">
        <input type="text" formControlName="satelliteName" readonly style="background-color: var(--ya-surface-bright);" />
      </ya-field>

      <ya-field label="Start Time">
        <ya-date-time-input formControlName="startDateTime" step="60" [showNow]="true" />
      </ya-field>

      <ya-field label="Duration (minutes)">
        <input type="number" formControlName="durationMinutes" min="5" max="60" placeholder="15" />
        <small>Typical pass duration is 5-20 minutes</small>
      </ya-field>

      <ya-field label="Pass Type">
        <ya-select formControlName="passType" [options]="passTypeOptions" />
      </ya-field>

      <ya-field label="Purpose">
        <ya-select formControlName="purpose" [options]="purposeOptions" />
      </ya-field>

      <ya-field label="Booking Type">
        <ya-select formControlName="ruleType" [options]="ruleTypeOptions" />
      </ya-field>

      <ya-field
        [label]="getFrequencyLabel()"
        *ngIf="showFrequencyField()">
        <input type="number" formControlName="frequencyDays" min="1" />
        <small>{{ getFrequencyNote() }}</small>
      </ya-field>

      <ya-field label="Priority" *ngIf="showAdvancedOptions">
        <ya-select formControlName="priority" [options]="priorityOptions" />
      </ya-field>

      <ya-field label="Frequency Band" *ngIf="showAdvancedOptions">
        <ya-select formControlName="frequencyBand" [options]="frequencyBandOptions" />
      </ya-field>

      <ya-field label="Expected Data Volume (MB)" *ngIf="showAdvancedOptions">
        <input type="number" formControlName="dataVolume" min="1" placeholder="100" />
      </ya-field>

      <ya-field label="Additional Requirements">
        <textarea formControlName="notes" rows="2" placeholder="Any special requirements or configurations (optional)"></textarea>
      </ya-field>

      <div style="margin: 16px 0;">
        <ya-button (click)="toggleAdvancedOptions()" appearance="link">
          {{ showAdvancedOptions ? 'Hide' : 'Show' }} Advanced Options
        </ya-button>
      </div>

    </form>

    <div *ngIf="submissionStatus !== 'idle'" class="submission-status">
      <div [class]="'status-' + submissionStatus">
        {{ submissionMessage }}
      </div>
    </div>


    <div class="ya-button-bar" style="gap: 16px;">
      <ya-button (click)="onCancel()">CANCEL</ya-button>
      <ya-button
        appearance="primary"
        (click)="onSubmit()"
        [disabled]="form.invalid || isSubmitting">
        {{ isSubmitting ? 'CREATING...' : 'CREATE BOOKING' }}
      </ya-button>
    </div>

  </ya-panel>
</ya-instance-page>