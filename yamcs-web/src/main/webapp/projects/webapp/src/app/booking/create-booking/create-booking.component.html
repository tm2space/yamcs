<ya-instance-page>
  <ya-instance-toolbar>
    <ng-template ya-instance-toolbar-label>
      <ya-page-icon-button
        [routerLink]="['/booking']"
        [queryParams]="{ c: yamcs.context }"
        icon="arrow_back" />
      Create New Booking
    </ng-template>
  </ya-instance-toolbar>

  <ya-panel>
    <form [formGroup]="bookingForm" (ngSubmit)="onSubmit()" class="ya-form">

      <ya-field label="Provider">
        <ya-select
          formControlName="providerId"
          [options]="providerOptions"
          required />
      </ya-field>

      <ya-field label="Start Date & Time">
        <ya-date-time-input
          formControlName="startDateTime"
          step="60"
          [showNow]="true"
          required />
      </ya-field>

      <ya-field label="Duration (hours)">
        <input type="number" formControlName="durationHours" min="0.5" step="0.5" required />
      </ya-field>

      <ya-field label="Booking Rule">
        <ya-select
          formControlName="ruleType"
          [options]="ruleTypeOptions"
          required />
      </ya-field>

      <ya-field
        label="Frequency (days)"
        *ngIf="showFrequencyField()"
        note="Number of days between recurring bookings">
        <input type="number" formControlName="frequencyDays" min="1" />
      </ya-field>

      <ya-field label="Purpose">
        <textarea formControlName="purpose" rows="3" required></textarea>
      </ya-field>

      <ya-field label="Additional Notes">
        <textarea formControlName="notes" rows="3"></textarea>
      </ya-field>

    </form>

    <div class="ya-button-bar">
      <ya-button (click)="onCancel()">CANCEL</ya-button>
      <ya-button
        appearance="primary"
        (click)="onSubmit()"
        [disabled]="bookingForm.invalid || isSubmitting">
        {{ isSubmitting ? 'CREATING...' : 'CREATE BOOKING' }}
      </ya-button>
    </div>

  </ya-panel>
</ya-instance-page>