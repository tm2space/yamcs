<ya-instance-page>
  <ya-instance-toolbar>
    <ng-template ya-instance-toolbar-label>
      <ya-page-icon-button
        [routerLink]="['/booking']"
        [queryParams]="{ c: yamcs.context }"
        icon="arrow_back" />
      All Bookings
    </ng-template>

    <ya-page-button (clicked)="refresh()" icon="refresh">Refresh</ya-page-button>
    <ya-page-button
      [routerLink]="['/booking/create']"
      [queryParams]="{ c: yamcs.context }"
      icon="add">New Booking</ya-page-button>
  </ya-instance-toolbar>

  <ya-panel>
    <table mat-table [dataSource]="bookings" class="ya-data-table expand">
      <!-- Booking ID Column -->
      <ng-container cdkColumnDef="providerBookingId">
        <th mat-header-cell *cdkHeaderCellDef>Booking ID</th>
        <td mat-cell *cdkCellDef="let booking">
          <span class="booking-id">
            {{ booking.providerBookingId || '-' }}
          </span>
        </td>
      </ng-container>

      <!-- Start Time Column -->
      <ng-container cdkColumnDef="startTime">
        <th mat-header-cell *cdkHeaderCellDef>Start Time</th>
        <td mat-cell *cdkCellDef="let booking">
          {{ formatDateTime(booking.startTime) }}
        </td>
      </ng-container>

      <!-- End Time Column -->
      <ng-container cdkColumnDef="endTime">
        <th mat-header-cell *cdkHeaderCellDef>End Time</th>
        <td mat-cell *cdkCellDef="let booking">
          {{ formatDateTime(booking.endTime) }}
        </td>
      </ng-container>

      <!-- Satellite Column -->
      <ng-container cdkColumnDef="satelliteId">
        <th mat-header-cell *cdkHeaderCellDef>Satellite</th>
        <td mat-cell *cdkCellDef="let booking">{{ booking.satelliteId }}</td>
      </ng-container>

      <!-- Provider Column -->
      <ng-container cdkColumnDef="provider">
        <th mat-header-cell *cdkHeaderCellDef>Provider</th>
        <td mat-cell *cdkCellDef="let booking">{{ booking.provider | titlecase }}</td>
      </ng-container>

      <!-- Max Elevation Column -->
      <ng-container cdkColumnDef="maxElevation">
        <th mat-header-cell *cdkHeaderCellDef>Max Elevation</th>
        <td mat-cell *cdkCellDef="let booking">
          {{ booking.maxElevation ? booking.maxElevation.toFixed(1) + 'Â°' : '-' }}
        </td>
      </ng-container>

      <!-- Booking Status Column -->
      <ng-container cdkColumnDef="gsStatus">
        <th mat-header-cell *cdkHeaderCellDef>GS Status</th>
        <td mat-cell *cdkCellDef="let booking">
          <span class="booking-status-badge" [class]="getBookingStatusClass(booking.gsStatus)">
            {{ booking.gsStatus | titlecase }}
          </span>
        </td>
      </ng-container>

      <!-- Status Column -->
      <ng-container cdkColumnDef="status">
        <th mat-header-cell *cdkHeaderCellDef>Status</th>
        <td mat-cell *cdkCellDef="let booking">
          <span class="status-badge" [class]="getStatusClass(booking.status)">
            {{ booking.status | titlecase }}
          </span>
        </td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container cdkColumnDef="actions">
        <th mat-header-cell *cdkHeaderCellDef>Actions</th>
        <td mat-cell *cdkCellDef="let booking">
          <button
            mat-icon-button
            [disabled]="booking.status !== 'pending'"
            [title]="booking.status === 'pending' ? 'View details' : 'Cannot modify ' + booking.status + ' booking'"
          >
            <mat-icon>info</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *cdkHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *cdkRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <div *ngIf="bookings.length === 0" class="empty-state">
      <mat-icon class="empty-icon">event_busy</mat-icon>
      <h3>No bookings found</h3>
      <ya-page-button
        [routerLink]="['/booking/create']"
        [queryParams]="{ c: yamcs.context }"
        icon="add">Create First Booking</ya-page-button>
    </div>
  </ya-panel>
</ya-instance-page>